"0",""
"0","library(scales)"
"0","top10_money <- player_df %>% "
"0","  mutate(label_N_usd = paste0(dollar(total_prize), "",\n"", N_participations, "" participations""),"
"0","         second_fifth = N_Top5 - N_1st) %>% "
"0","  select(name, N_participations, total_prize, N_1st, second_fifth, label_N_usd, N_Top5) %>% "
"0","  arrange(desc(total_prize)) %>% "
"0","  slice_head(n = 10) %>% "
"0","  pivot_longer(cols = -c(name, N_participations, total_prize, label_N_usd, N_Top5), names_to = ""places"", values_to = ""N"")  "
"0",""
"0","top10_money$places <- gsub(pattern = ""N_1st"", replacement = ""1st place"", x = top10_money$places)"
"0","top10_money$places <- gsub(pattern = ""second_fifth"", replacement = ""2nd-5th place"", x = top10_money$places)"
"0",""
"0","top10_money$name = factor(top10_money$name, levels = unique(top10_money$name))"
"0","top10_money$places = factor(top10_money$places, levels = c(""2nd-5th place"", ""1st place""))"
"0","#top10_money <- top10_money %>% group_by(name) %>% add_count(wt = N)"
"0",""
"0","top10_money %>% "
"0","  ggplot(aes(x = name, y = N, fill = places, label = N)) +"
"0","  geom_col(position = ""stack"") +"
"0","  geom_text(size = 3, position = position_stack(vjust = 0.5)) + "
"0","  geom_text(data = top10_money, aes(x = name, y = N_Top5, label = label_N_usd), nudge_y = 7, size = 3) + "
"0","  coord_flip() + "
"0","  scale_y_continuous(limits = c(0, 50)) +"
"0","  scale_x_discrete(limits=rev) +"
"0","  labs(x = """", y = ""# Winning the tournament or placing Top5, N participations, Total prize money"","
"0","       fill = ""Position:"") +"
"0","  guides(fill = guide_legend(reverse=T)) +"
"0","  theme_light() +"
"0","  theme(axis.text.x = element_blank(), axis.ticks.x = element_blank())"
"0",""
