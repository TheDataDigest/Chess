"0","# 7) Winning % with white/black"
"0","games_color <- results_df %>% pivot_longer(cols = -c(username, games_w_White, games_w_Black)) %>% "
"0","  mutate(percent_white = value / games_w_White,"
"0","         percent_black = value / games_w_Black,"
"0","         color = factor(gsub(pattern = "".+_"", x = name, replacement = """"), levels = c(""White"", ""Black"")),"
"0","         result = factor(gsub(pattern = ""_.+"", x = name, replacement = """"), levels = c(""lose"", ""draw"", ""win""))) "
"0","names(games_color)[4] <- ""result_color"""
"0",""
"0","# make a stacked barchart for top 10 players (how common is it in this tournament)"
"0","top20 <- player_df %>% filter(N_participations > 10) %>% arrange(desc(avg_score)) %>% head(20) %>% pull(username)"
"0",""
"0","## 7a) wins with white ----"
"0","games_color_N20 <- games_color %>% filter(username %in% top20)"
"0","games_color_N20$name <- player_df$name[match(games_color_N20$username, player_df$username)]"
"0",""
"0","player_white_win <- games_color_N20 %>% filter(color == ""White"", result == ""win"") %>% arrange(percent_white) %>% pull(name)"
"0","player_white_loss <- games_color_N20 %>% filter(color == ""White"", result == ""lose"") %>% arrange(percent_white) %>% pull(name)"
"0",""
"0","games_color_N20$name_win_White <- factor(games_color_N20$name, levels = player_white_win)"
"0","games_color_N20$result_win <- factor(games_color_N20$result, levels = c(""lose"", ""draw"", ""win""))"
"0","# sort by lowest loss-% and by highest win-%"
"0",""
"0","#player_df %>% filter(username %in% top20) %>% select(username, name) %>% right_join(games_color_N20)"
"0",""
"0","p_white_win <- games_color_N20 %>% filter(color == ""White"") %>% "
"0","  ggplot(aes(x = percent_white, fill = result_win, y = name_win_White)) +"
"0","  geom_col(position = ""stack"") +  "
"0","  scale_x_continuous(labels = scales::percent, expand = c(0, 0)) +"
"0","  geom_text(data = games_color_N20 %>% filter(color == ""White"" & result == ""win""),"
"0","            aes(label = paste0(round(percent_white*100, 1),""%"")), "
"0","            position = position_stack(vjust = 0.5), "
"0","            size = 3, color = ""white"") +"
"0","  scale_fill_manual(values = c(""#F8766D"", ""#619CFF"", ""#00BA38"")) +"
"0","  labs(x = """", y = """", fill = ""Result:"") +"
"0","  theme_light()"
"0",""
"0","games_color_N20$name_lose_White <- factor(games_color_N20$name, levels = rev(player_white_loss))"
"0","games_color_N20$result_lose <- factor(games_color_N20$result, levels = c(""win"", ""draw"", ""lose""))"
"0","p_white_loss <- games_color_N20 %>% filter(color == ""White"") %>% "
"0","  ggplot(aes(x = percent_white, fill = result_lose, y = name_lose_White)) +"
"0","  geom_col(position = ""stack"") +  "
"0","  scale_x_continuous(labels = scales::percent, expand = c(0, 0)) +"
"0","  geom_text(data = games_color_N20 %>% filter(color == ""White"" & result == ""lose""),"
"0","            aes(label = paste0(round(percent_white*100, 1),""%"")), "
"0","            position = position_stack(vjust = 0.7), "
"0","            size = 3, color = ""white"") +"
"0","  theme_light() +"
"0","  scale_fill_manual(values = c(""#00BA38"", ""#619CFF"", ""#F8766D"")) +"
"0","  labs(x = """", y = """", fill = ""Result:"")"
"0",""
"0",""
"0","## 7b) repeat for black ----"
"0","player_black_win <- games_color_N20 %>% filter(color == ""Black"", result == ""win"") %>% arrange(percent_black) %>% pull(name)"
"0","player_black_loss <- games_color_N20 %>% filter(color == ""Black"", result == ""lose"") %>% arrange(percent_black) %>% pull(name)"
"0",""
"0","games_color_N20$name_win_Black <- factor(games_color_N20$name, levels = player_black_win)"
"0","games_color_N20$result <- factor(games_color_N20$result, levels = c(""lose"", ""draw"", ""win""))"
"0","# sort by lowest loss-% and by highest win-%"
"0","p_black_win <- games_color_N20 %>% filter(color == ""Black"") %>% "
"0","  ggplot(aes(x = percent_black, fill = result, y = name_win_Black)) +"
"0","  geom_col(position = ""stack"") +  "
"0","  scale_x_continuous(labels = scales::percent, expand = c(0, 0)) +"
"0","  geom_text(data = games_color_N20 %>% filter(color == ""Black"" & result == ""win""),"
"0","            aes(label = paste0(round(percent_black*100, 1),""%"")), "
"0","            position = position_stack(vjust = 0.5), "
"0","            size = 3, color = ""white"") +"
"0","  theme_light() +"
"0","  scale_fill_manual(values = c(""#F8766D"", ""#619CFF"", ""#00BA38"")) +"
"0","  labs(x = """", y = """", fill = ""Result:"")"
"0",""
"0","# interesting - draw is most common over the table classical chess, but least likely in 3min events"
"0",""
"0","## stacked bar charts wins, draws, losses in percent, facet_wrap black and white or by player split (facet grid)"
"0","# top 10 players black and white side by side (grid)"
"0","games_color_N20$percent <- games_color_N20$percent_white"
"0","games_color_N20$percent[games_color_N20$color == ""Black""] <- games_color_N20$percent_black[games_color_N20$color == ""Black""]"
"0",""
"0","games_color_N20$name_lose_Black <- factor(games_color_N20$name, levels = rev(player_black_loss))"
"0","games_color_N20$result <- factor(games_color_N20$result, levels = c(""win"", ""draw"", ""lose""))"
"0","p_black_loss <- games_color_N20 %>% filter(color == ""Black"") %>% "
"0","  ggplot(aes(x = percent_black, fill = result, y = name_lose_Black)) +"
"0","  geom_col(position = ""stack"") +  "
"0","  scale_x_continuous(labels = scales::percent, expand = c(0, 0)) +"
"0","  geom_text(data = games_color_N20 %>% filter(color == ""Black"" & result == ""lose""),"
"0","            aes(label = paste0(round(percent_black*100, 1),""%"")), "
"0","            position = position_stack(vjust = 0.5), "
"0","            size = 3, color = ""white"") +"
"0","  theme_light() +"
"0","  scale_fill_manual(values = c(""#00BA38"", ""#619CFF"", ""#F8766D"")) +"
"0","  labs(x = """", y = """", fill = ""Result:"")"
"0",""
"0",""
"0",""
"0","# player_winning_chance <- player_df %>% filter(name %in% games_color_N20$name) %>% arrange(desc(winning_chance)) %>%   pull(name) %>% unique()"
"0","# games_color_N20$name_best <- factor(games_color_N20$name, levels = rev(player_winning_chance))"
"0",""
"0","# games_color_N20 %>% "
"0","#   mutate(result2 = factor(result, levels = c(""lose"", ""draw"", ""win""))) %>% "
"0","#   ggplot(aes(x = percent, fill = result2, y = name_best)) +"
"0","#   geom_col(position = ""stack"") +  "
"0","#   scale_x_continuous(labels = scales::percent, expand = c(0, 0)) +"
"0","#   geom_text(aes(label = paste0(round(percent*100, 1),""%"")), "
"0","#             position = position_stack(vjust = 0.5), "
"0","#             size = 3, color = ""white"") +"
"0","#   facet_wrap(~color) +"
"0","#   theme_light() +"
"0","#   scale_fill_manual(values = rev(c(""#00BA38"", ""#619CFF"", ""#F8766D""))) +"
"0","#   labs(fill = ""Result:"", x= """", y="""")"
"0",""
"0",""
"0",""
